const http = require("http");
const fs = require("fs");
const path = require("path");
const sendResponse = require("./sendResponse");
const getContentType = require("./getContentType");

const connect = http
  .createServer((request, response) => {
    switch (request.url) {
      case "/":
        sendResponse("index.html", "text/html", response);
        break;

      case "/upload":
        getData(request, response);
        break;

      default:
        sendResponse(request.url, getContentType(request.url), response);
        break;
    }
  })
  .listen(3000, (er) => (er ? console.log(er) : console.log("server created")));

function getData(request, response) {
  let body = "";
  request.on("data", (chunk) => {
    body += chunk.toString();
  });
  request.on("end", () => {
    console.log(JSON.parse(body));
    response.end();
  });
}
